<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ver Ã“rdenes de Trabajo - GMAO</title>
    <link rel="stylesheet" href="ver-ordenes-mantenimiento.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div id="navbar-container"></div>

    <div class="container">
        <!-- Barra de herramientas -->
        <div class="toolbar-container" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; gap: 15px;">
            <!-- Botones de modo de vista -->
            <div class="view-mode-buttons" style="display: flex; gap: 10px;">
                <button id="btn-kanban" class="view-btn active" onclick="cambiarVista('kanban')" style="padding: 10px 20px; background: var(--planasa-green); color: white; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 500;">
                    <i class="fas fa-columns"></i> Kanban
                </button>
                <button id="btn-tabla" class="view-btn" onclick="cambiarVista('tabla')" style="padding: 10px 20px; background: #f3f4f6; color: #374151; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 500;">
                    <i class="fas fa-table"></i> Tabla
                </button>
                <button id="btn-calendario" class="view-btn" onclick="cambiarVista('calendario')" style="padding: 10px 20px; background: #f3f4f6; color: #374151; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 500;">
                    <i class="fas fa-calendar-alt"></i> Calendario
                </button>
            </div>

            <!-- Filtros -->
            <div class="filtros-container" style="display: flex; gap: 10px;">
                <select id="filtroResponsable" onchange="filtrarOrdenes()">
                    <option value="">Todos los tÃ©cnicos</option>
                    <option value="Carlos MÃ©ndez">Carlos MÃ©ndez</option>
                    <option value="Ana GarcÃ­a">Ana GarcÃ­a</option>
                    <option value="Luis RodrÃ­guez">Luis RodrÃ­guez</option>
                    <option value="MarÃ­a LÃ³pez">MarÃ­a LÃ³pez</option>
                </select>
                <select id="filtroPrioridad" onchange="filtrarOrdenes()">
                    <option value="">Todas las prioridades</option>
                    <option value="CrÃ­tica">ðŸ”´ CrÃ­tica</option>
                    <option value="Alta">ðŸŸ  Alta</option>
                    <option value="Media">ðŸŸ¡ Media</option>
                    <option value="Baja">ðŸŸ¢ Baja</option>
                </select>
            </div>
        </div>

        <!-- Kanban Board -->
        <div class="kanban-board">
            <!-- Columna Por Hacer -->
            <div class="kanban-column" data-estado="por-hacer">
                <div class="column-header por-hacer">
                    <h3><i class="fas fa-clock"></i> Por Hacer</h3>
                    <span class="counter" id="counter-por-hacer">0</span>
                </div>
                <div class="column-content" id="column-por-hacer">
                    <div class="orden-placeholder">
                        <i class="fas fa-clipboard-list"></i>
                        <p>No hay Ã³rdenes pendientes</p>
                    </div>
                </div>
            </div>

            <!-- Columna En Progreso -->
            <div class="kanban-column" data-estado="en-progreso">
                <div class="column-header en-progreso">
                    <h3><i class="fas fa-play"></i> En Progreso</h3>
                    <span class="counter" id="counter-en-progreso">0</span>
                </div>
                <div class="column-content" id="column-en-progreso">
                    <div class="orden-placeholder">
                        <i class="fas fa-wrench"></i>
                        <p>No hay Ã³rdenes en progreso</p>
                    </div>
                </div>
            </div>

            <!-- Columna Parado -->
            <div class="kanban-column" data-estado="parado">
                <div class="column-header parado">
                    <h3><i class="fas fa-pause"></i> Parado</h3>
                    <span class="counter" id="counter-parado">0</span>
                </div>
                <div class="column-content" id="column-parado">
                    <div class="orden-placeholder">
                        <i class="fas fa-hand-paper"></i>
                        <p>No hay Ã³rdenes paradas</p>
                    </div>
                </div>
            </div>

            <!-- Columna Hecho -->
            <div class="kanban-column" data-estado="hecho">
                <div class="column-header hecho">
                    <h3><i class="fas fa-check"></i> Hecho</h3>
                    <span class="counter" id="counter-hecho">0</span>
                </div>
                <div class="column-content" id="column-hecho">
                    <div class="orden-placeholder">
                        <i class="fas fa-check-circle"></i>
                        <p>No hay Ã³rdenes completadas</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista Tabla -->
        <div id="vista-tabla" style="display: none; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <table id="tabla-ordenes" style="width: 100%; border-collapse: collapse;">
                <thead style="background: var(--planasa-green); color: white;">
                    <tr>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">ID</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">Activo</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">Tipo</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">Responsable</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">Prioridad</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">Estado</th>
                        <th style="padding: 15px; text-align: left; font-weight: 600;">Fecha Inicio</th>
                        <th style="padding: 15px; text-align: center; font-weight: 600;">Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-body">
                    <!-- Se llena dinÃ¡micamente -->
                </tbody>
            </table>
        </div>

        <!-- Vista Calendario -->
        <div id="vista-calendario" style="display: none; background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div id="calendario-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button onclick="cambiarMes(-1)" style="padding: 8px 16px; background: var(--planasa-green); color: white; border: none; border-radius: 6px; cursor: pointer;">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <h3 id="calendario-titulo" style="margin: 0; color: var(--planasa-green-dark); font-size: 1.3rem;"></h3>
                <button onclick="cambiarMes(1)" style="padding: 8px 16px; background: var(--planasa-green); color: white; border: none; border-radius: 6px; cursor: pointer;">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div id="calendario-grid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px;">
                <!-- Se llena dinÃ¡micamente -->
            </div>
        </div>
    </div>

    <!-- Modal para ver detalles de orden -->
    <div id="modal-detalle" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-titulo">Detalle de Orden de Trabajo</h2>
                <button class="modal-close" onclick="cerrarModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-contenido">
                <!-- Contenido se carga dinÃ¡micamente -->
            </div>
            <div class="modal-footer">
                <button class="btn-guardar" onclick="guardarCambios()">
                    <i class="fas fa-save"></i> Guardar Cambios
                </button>
                <button class="btn-cancelar" onclick="cerrarModal()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <script src="ver-ordenes-mantenimiento.js"></script>
    <script>
        // Cargar navbar
        fetch('../Components/navbar.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('navbar-container').innerHTML = html;
                
                // Mostrar el botÃ³n volver despuÃ©s de cargar la navbar
                setTimeout(() => {
                    const btnVolver = document.getElementById('btn-volver-nav');
                    if (btnVolver) {
                        btnVolver.style.display = 'flex';
                    }
                }, 100);
            })
            .catch(error => {
                console.error('Error cargando navbar:', error);
            });
            
        // FunciÃ³n para volver atrÃ¡s
        function volverAtras() {
            window.history.back();
        }
    </script>
</body>
</html>